{"version":3,"file":"js/928.fdbadee2.js","mappings":"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","sources":["webpack://summary/./src/hooks/web/useSystem.ts","webpack://summary/./node_modules/vue-loader/dist/index.js","webpack://summary/./src/views/system/department/DepartmentModal.vue"],"sourcesContent":["import { ref } from \"vue\";\nimport {\n  getDepartmentList,\n  getRoleList,\n  getMenuList,\n} from \"@/api/system/system\";\nimport type { MenuType } from \"@/types/user\";\n\nexport default function () {\n  // 部门配置\n  const departmentProps = {\n    children: \"children\",\n    label: \"name\",\n    value: \"id\",\n  };\n  // 菜单配置\n  const menuProps = {\n    children: \"children\",\n    label: (data: MenuType) => {\n      return data.meta.title;\n    },\n    value: \"id\",\n  };\n  // 部门数据\n  const departmentList = ref();\n  // 角色数据\n  const roleList = ref();\n  // 菜单数据\n  const menuList = ref();\n\n  // 获取部门数据\n  const getDepartmentData = () => {\n    getDepartmentList().then((res) => {\n      departmentList.value = res.data.result;\n    });\n  };\n\n  // 获取角色数据\n  const getRoleData = () => {\n    getRoleList().then((res) => {\n      roleList.value = res.data.result;\n    });\n  };\n\n  // 获取菜单数据\n  const getMenuData = () => {\n    getMenuList().then((res) => {\n      menuList.value = res.data.result;\n    });\n  };\n\n  return {\n    departmentProps,\n    menuProps,\n    departmentList,\n    roleList,\n    menuList,\n    getDepartmentData,\n    getRoleData,\n    getMenuData,\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, isRef as _isRef, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\"取消\")\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"确定\")\n\nimport { computed, nextTick, onMounted, reactive, ref, watch } from \"vue\";\nimport { ElMessage } from \"element-plus\";\nimport { departmentInsert, departmentUpdate } from \"@/api/system/system\";\nimport useSystem from \"@/hooks/web/useSystem\";\nimport type { FormInstance, FormRules } from \"element-plus\";\nimport type { DepartmentType } from \"@/types/user\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'DepartmentModal',\n  props: {\n    modalVisible: { type: Boolean },\n    modalTitle: null,\n    modalData: null\n  },\n  emits: [\"toggleVisible\", \"refresh\"],\n  setup(__props: any, { emit }) {\n\nconst props = __props as {\n  modalVisible: boolean;\n  modalTitle: string;\n  modalData?: DepartmentType;\n}\n\nconst { departmentProps, departmentList, getDepartmentData } = useSystem();\n\n\n\nconst formRef = ref<FormInstance>();\nconst form = reactive({\n  parentId: \"\",\n  name: \"\",\n  code: \"\",\n});\nconst rules = reactive<FormRules>({\n  name: [{ required: true, message: \"请输入部门名称！\", trigger: \"blur\" }],\n  code: [{ required: true, message: \"请输入部门编号！\", trigger: \"blur\" }],\n});\nconst pattern = ref(1);\n\n// 模块显示/隐藏\n\nconst visible = computed({\n  get() {\n    return props.modalVisible;\n  },\n  set() {\n    cancel();\n  },\n});\n\nwatch(\n  () => props.modalData,\n  (newVal) => {\n    nextTick(() => {\n      pattern.value = 2;\n      Object.assign(form, newVal);\n    });\n  }\n);\n\nonMounted(() => {\n  getDepartmentData();\n});\n\n// 取消\nconst cancel = () => {\n  formRef.value?.resetFields();\n  pattern.value = 1;\n  emit(\"toggleVisible\", false);\n};\n\n// 确定\nconst confirm = (formEl: FormInstance | undefined) => {\n  formEl?.validate((valid) => {\n    if (valid) {\n      if (pattern.value === 1) {\n        departmentInsert(form).then((res) => {\n          ElMessage.success(res.data.message);\n          formEl.resetFields();\n          emit(\"toggleVisible\", false);\n          emit(\"refresh\");\n        });\n      } else {\n        departmentUpdate(form).then((res) => {\n          ElMessage.success(res.data.message);\n          formEl.resetFields();\n          emit(\"toggleVisible\", false);\n          emit(\"refresh\");\n        });\n      }\n    }\n  });\n};\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_tree_select = _resolveComponent(\"el-tree-select\")!\n  const _component_el_form_item = _resolveComponent(\"el-form-item\")!\n  const _component_el_input = _resolveComponent(\"el-input\")!\n  const _component_el_form = _resolveComponent(\"el-form\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n  const _component_el_dialog = _resolveComponent(\"el-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_el_dialog, {\n    modelValue: _unref(visible),\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => (_isRef(visible) ? (visible).value = $event : null)),\n    title: __props.modalTitle,\n    width: \"38%\",\n    draggable: \"\",\n    \"close-on-click-modal\": false,\n    \"close-on-press-escape\": false,\n    class: \"custom-dialog\"\n  }, {\n    footer: _withCtx(() => [\n      _createVNode(_component_el_button, {\n        onClick: _cache[3] || (_cache[3] = ($event: any) => (cancel()))\n      }, {\n        default: _withCtx(() => [\n          _hoisted_1\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_el_button, {\n        onClick: _cache[4] || (_cache[4] = ($event: any) => (confirm(formRef.value))),\n        type: \"primary\"\n      }, {\n        default: _withCtx(() => [\n          _hoisted_2\n        ]),\n        _: 1\n      })\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_component_el_form, {\n        ref_key: \"formRef\",\n        ref: formRef,\n        model: form,\n        rules: rules,\n        \"label-width\": \"90px\"\n      }, {\n        default: _withCtx(() => [\n          _createVNode(_component_el_form_item, {\n            label: \"上级部门\",\n            prop: \"parentId\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_tree_select, {\n                modelValue: form.parentId,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((form.parentId) = $event)),\n                data: _unref(departmentList),\n                props: _unref(departmentProps),\n                \"render-after-expand\": false,\n                clearable: \"\",\n                \"check-strictly\": \"\",\n                placeholder: \"请选择上级部门\"\n              }, null, 8, [\"modelValue\", \"data\", \"props\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, {\n            label: \"部门名称\",\n            prop: \"name\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input, {\n                modelValue: form.name,\n                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((form.name) = $event))\n              }, null, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, {\n            label: \"部门编号\",\n            prop: \"code\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input, {\n                modelValue: form.code,\n                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((form.code) = $event))\n              }, null, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }, 8, [\"model\", \"rules\"])\n    ]),\n    _: 1\n  }, 8, [\"modelValue\", \"title\"]))\n}\n}\n\n})","import script from \"./DepartmentModal.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./DepartmentModal.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["departmentProps","children","label","value","menuProps","data","meta","title","departmentList","ref","roleList","menuList","getDepartmentData","getDepartmentList","then","res","result","getRoleData","getRoleList","getMenuData","getMenuList","_hoisted_1","_createTextVNode","_hoisted_2","_defineComponent","__name","props","modalVisible","type","Boolean","modalTitle","modalData","emits","setup","__props","emit","useSystem","formRef","form","reactive","parentId","name","code","rules","required","message","trigger","pattern","visible","computed","get","set","cancel","watch","newVal","nextTick","Object","assign","onMounted","resetFields","confirm","formEl","validate","valid","departmentInsert","ElMessage","departmentUpdate","_ctx","_cache","_component_el_tree_select","_resolveComponent","_component_el_form_item","_component_el_input","_component_el_form","_component_el_button","_component_el_dialog","_openBlock","_createBlock","modelValue","_unref","$event","_isRef","width","draggable","class","footer","_withCtx","_createVNode","onClick","default","_","ref_key","model","prop","clearable","placeholder","__exports__"],"sourceRoot":""}